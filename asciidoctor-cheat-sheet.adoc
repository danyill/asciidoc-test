= Asciidoctor Quick Reference
Simon Maple <https://twitter.com/sjmaple>; Robert Scholte <https://twitter.com/rfscholte>
:authorbio_1: Java Champion and Developer Advocate at Snyk
:authorbio_2: CEO of Sourcegrounds, Chairman of the Apache Maven project
:icons: font
:sectanchors:
// :stylesheet: ./asciidoctor.css
// :linkcss:
// :docinfo: shared
// :docinfodir: base
// :stylesdir: base
// :stylesheet: style.css
:stem:
:uri-ventilated-prose: https://vanemden.wordpress.com/2009/01/01/ventilated-prose/
:uri-vcses: https://git-scm.com/book/en/v2/Getting-Started-About-Version-Control
// :toc: left
// :url-docs: https://asciidoctor.org/docs
// :url-gem: https://rubygems.org/gems/asciidoctor

== Document Structure

=== Header

The header must be flush with left margin

 = Document Title
 Author Name <author@example.org>
 v1.0, 2019-01-01: Revision remark

All of these are optional.

These can also be set using attributes. Attributes in Asciidoctor always are:

  :key: value

For example:

  :doctitle: Wishing Upon A Star
  :author: Galileo Galilei
  :email: stars@universe.com
  :revnumber: v1.0
  :revdate: 2019-01-01
  :revremark: First edition

=== Document-Wide Attributes

After the title, author, version and date information, document-wide attributes can be set.
These can be any arbitrary `:key: value` but some have special meaning and turn on document features.

Here are some commonly used attributes.

[none]
* `pass:[:sectanchors:]` -- creates an empty link (a section entity, ยง) visible when hovering just left of the section title
* `pass:[:sectlinks:]` -- makes each section title a link
* `pass:[:sectnums:]` -- numbers all sections
* `pass:[:sectnumlevels: 3]` -- determines the depth of numbering. Default is 3
* `pass:[:nofooter:]` -- remove footer at bottom of document
* `pass:[:icons: font]` -- Enable FontAwesome to support admonitions, callouts and icons
* `pass:[:reproducible:]` -- Removes `last-updated` date from html to avoid changes caused by this

=== Sections

Sections must also be flush with left margin

 = Document Title (Level 0)
 == Level 1
 === Level 2
 ==== Level 3
 ===== etc...
 == Back at Level 1

=== Generating a Table of Contents

In the document header, set `:toc:` and a table of contents is inserted directly below the document header.
The following options are also available:

[none]
* `pass:[:toc: preamble]` -- inserts the TOC just below the preamble
* `pass:[:toc: macro:]` -- allows use of the block toc macro [.nobreak]#`toc::[]`# for insertion anywhere in the document
* `pass:[:toc: left|right]`  -- inserts a side column for the table of contents if screen width allows


[#paragraphs]
== Paragraphs

=== Line Breaks

A blank line separates paragraphs.

Line breaks are not preserved by default.
This is called {uri-ventilated-prose}[ventilated prose].
It works well with {uri-vcses}[VCSes].

Set the `hardbreaks` option to preserve line breaks.

  [%hardbreaks]
  This paragraph carries the `hardbreaks` option.
  Line breaks are now preserved.

For a "`one-off`" line break, at the end use a space and a `+` +
to break the line.

Indenting with one or more spaces creates a literal paragraph.
This disables text formatting, preserves spaces and line breaks, and is displayed in a monospaced font.
Like this:

  C:\Program Files\SomethingAwesome.exe

=== Alignment

To align a block, set a role in the form: [.nobreak]`[.text-{left|center|right|justify}]`:

e.g.

  [.text-center]
  This text would be centered

== Text Formatting

Asciidoc has two types of formatting:

* _Constrained_ for formatting at word boundaries
* _Unconstrained_ which apply anywhere

=== Constrained

[none]
* `pass:[*strong importance/bold*]` -> *strong importance*
* `pass:[_stress emphasis/italics_]` -> _stress emphasis/italics_
* `pass:[monospace/typewriter]` -> `monospace/typewriter`
* Curly quotes: `pass:none["`double`"]`/`pass:none['`single`']` -> "`double`"/'`single`'
* Highlighting: `pass:none[#highlighted#]` -> #highlighted#

=== Unconstrained

[none]
* `pass:[**D**o**N**ot**R**epeat]` -> **D**o**N**ot**R**epeat
* `pass:[fan__freakin_tastic]` -> fan__freakin__tastic
* `pass:[```mono``culture]` -> ``mono``culture
* Highlighting: `pass:none[high##light##ed]` -> high##light##ed

=== Superscript and Subscript

[none]
* `pass:[^Super^script]` -> ^Super^script
* `pass:[~Sub~script]` -> ~Sub~script

You can use this to write e=mc^2^ and H~2~O but checkout <<Equations>> as well.

=== Custom Roles

A custom role can be applied using a style applied to hash symbols, like this:

[none]
* `pass:[[small\]#small text#]` -> [small]#small text#

Use dots between multiple roles, e.g.

[none]
* `pass:[[.small.green\]#small text#]` -> [.small.green]#small text#

== Comments

Comments are not included in the output and can be useful for audit-trail, review, commentary and outstanding items.

 // commented lines begin like this and are not shown in the output

 ////
 This is how we fence
 multi-line comments
 ////

Sometimes in Asciidoc items "`stick together`" (e.g. list items). Use a comment line to separate them.

== Admonitions

Asciidoctor has 5 default admonition types: `NOTE:`, `TIP:`, `IMPORTANT:`, `CAUTION:` and `WARNING:`.

TIP: Start a paragraph like this one beginning `TIP:` and it will be displayed like this to catch your reader's attention.

You can also fence an admonition using `====` and set a title by starting a line with `.` This can help with complex multi-line content.

Here's an example:

  [IMPORTANT]
  .Feeding the Werewolves
  ====
  Werewolves are hardy community members but remember to avoid chocolate.

  They are also lactose intolerant so avoid dairy.
  ====

== Links

Some types of links will be automatically identifier (mailto, web URLs). Otherwise use the `\link:<URI>[identifier]` macro.

  https://example.org/page[A webpage]
  mailto:hello@example.org[Email to say hello!]
  link:tel:+123456789[A telephone number]
  link:../path/to/file.txt[A local file]
  xref:document.adoc[A sibling document]

[#lists.columnbreak]
== Lists -- The Basics

You can mix and match with unordered and ordered lists. Here's how they work:

=== Unordered

Unordered lists can use `*` or `-` characters but hyphens only work for single level lists.

....
  * level 1
  ** level 2
  *** level 3
  **** etc.
  * back at level 1
  +
  Use the + at the start of a line - a list continuation to attach multi-line text to a list item.
....

A role can be applied on the line before the list using `[square|circle|disc|none|unstyled]`. The default is a bullet.

Like most blocks in Asciidoc, a title can be provided using a [.no-break]#`.<title>`# before the content (and role). Here's an example:

.A clever title
[square]
* Here we are, using squares
* We wrote `[square]` on the line before the first `*`
* And `.A clever title` on the line above that

=== Ordered

Ordered lists can use numbers but then you must keep them in order yourself. You can start each numbered item with a `.`:

....
  . Step 1
  . Step 2
  .. Step 2a
  .. Step 2b
  . Step 3
....

A role can be applied on the line before the list using `[arabic|decimal|loweralpha|upperalpha|lowerroman|upperroman|lowergreek]`. The default is 1,2,3... which is `arabic`.

=== Specifying the start

You can specify the start of an ordered list by setting a start attribute after the role or separately e.g.

  .Remember your Roman numerals?
  [lowerroman,start=4]
  . is one
  . is two
  . is three

or 

  [start=2]
  . the second
  . the third

Irrespective of the style, `start=` should be followed by a number (like on the keyboard!)

[#anchors.pagebreak]
== Anchors, References and Footnotes

The legacy style is:

  [[idname,reference text]]

or written using normal block attributes as

  [#idname,reftext=reference text]`

A paragraph (or any block) with an anchor (aka ID) and reftext.

  See <<idname>> or <<idname,optional text of internal link>>.

Cross references to other documents:

  xref:document.adoc#idname[Jumps to anchor in another document].

Finally, footnotesfootnote:[This is the text of the footnote.]:

  This paragraph has a footnote.footnote:[This is the text of the footnote.]

[#anchors2.pagebreak]
== Blocks

--
open - a general-purpose content wrapper; useful for enclosing content to attach to a list item
--

// recognized types include CAUTION, IMPORTANT, NOTE, TIP, and WARNING
// enable admonition icons by setting `:icons: font` in the document header
[NOTE]
====
admonition - a notice for the reader, ranging in severity from a tip to an alert
====

====
example - a demonstration of the concept being documented
====

.Toggle Me
[%collapsible]
====
collapsible - these details are revealed by clicking the title
====

****
sidebar - auxiliary content that can be read independently of the main content
****

....
literal - an exhibit that features program output
....

----
listing - an exhibit that features program input, source code, or the contents of a file
----

[,language]
----
source - a listing that is embellished with (colorized) syntax highlighting
----

```language
fenced code - a shorthand syntax for the source block
```

[,attribution,citetitle]
____
quote - a quotation or excerpt; attribution with title of source are optional
____

[verse,attribution,citetitle]
____
verse - a literary excerpt, often a poem; attribution with title of source are optional
____

++++
pass - content passed directly to the output document; often raw HTML
++++

// activate stem support by adding `:stem:` to the document header
[stem]
++++
x = y^2
++++

////
comment - content which is not included in the output document
////

== Tables

.Table Attributes
[cols=>1h;2d,width=50%,frame=topbot]
|===
| Attribute Name | Values

| options
| header,footer,autowidth

| cols
| colspec[;colspec;...]

| grid
| all \| cols \| rows \| none

| frame
| all \| sides \| topbot \| none

| stripes
| all \| even \| odd \| none

| width
| (0%..100%)

| format
| psv {vbar} csv {vbar} dsv
|===

== Multimedia

// image::screenshot.png[block image,800,450]

// Press image:reload.svg[reload,16,opts=interactive] to reload the page.

// video::movie.mp4[width=640,start=60,end=140,options=autoplay]

// video::aHjpOzsQ9YI[youtube]

// video::300817511[vimeo]

== Breaks

// thematic break (aka horizontal rule)
---

// page break
<<<

////

== More

Extensions
asciidoctor-diagram

Antora
Hugo
Jekyll

ToC

////


////

Moved -- advanced topics.

=== Includes

Bring content in from other files

 // must be flush with left margin
 include::basics.adoc[]

 // define -a allow-uri-read to allow content to be read from URI
 include::https://example.org/installation.adoc[]


== Encrypt your Secrets 1 2 3 4 5 6 7 8 9 10

```
$ mvn --encrypt-master-password
Master password: *********
{encrypted_master_password}
```

Store this in `~/.m2/settings-security.xml`

```xml
<settingsSecurity>
 <master>{encrypted_master_password}</master>
</settingsSecurity>
```
Now encrypt your server password:

```
mvn --encrypt-password
Master password: *********
{encrypted_password}
```

Store this in your `settings.xml` file as follows:

```xml
<server>
 <id>my.server</id>
 <username>smaple</username>
 <password>{encrypted_password}</password>
</server>
```

== Don't use passwords in the CLI

Never enter passwords in plain text on the CLI:

[source,sh,role=dont]
----
$ mvn --encrypt-master-password P@ssw0rd

$ mvn --encrypt-password P@ssw0rd
----

== Always Use HTTPS

Use HTTPS to connect to remote Maven repositories, to avoid MITM attacks.

Ensure your `<repositories>` and `<pluginRepositories>` use https in their URLs.

== Check Dependency Health

Verify the health of your third-party libraries by confirming they have:

[.do]
* [x] A team of committers
* [x] Well documented security policies
* [x] Regular updates and releases

== Test for Known Vulnerabilities

Do not use Maven dependencies with known vulnerabilities. +
Use a tool like Snyk to:

[.do]
* [x] Test your app for known vulnerabilities.
* [x] Automatically fix issues that exist.
* [x] Continuously monitor for new vulnerabilities

== Test your Checksums

As part of validating the authenticity of your dependencies,
test their checksums using the -C flag on Maven commands:

```
$ mvn -C install
// fail if checksums donโt match

$ mvn -c install
// warn if checksums donโt match
```

== Don't use Properties for Passwords

Never store your secrets in your pom.xml properties.

[source,xml,role=dont]
----
<properties>
  <my.property>P@ssw0rd</my.property>
</properties>
----

== Use Maven developers/roles

Use Maven roles to state who should be contacted for security issues.

```xml
<developers>
 <developer>
   <id>grander</id>
   <name>Danny Grander</name>
   <email>security@your_org.com</email>
   <roles>
     <role>security</role>
   </roles>
 <developer>
<developers>
```

== Stay up-to-date

Try to stay on the latest releases of Maven. Check the download page for the latest version.

Avoid Maven 3.0.4 as it ignores certificates for HTTPS connections.

== Check Security Bulletins

Monitor the security bulletins the Apache Maven team publish on the
https://maven.apache.org/security.html[Maven site].


////
